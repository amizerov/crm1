# üîí –ü–û–õ–ù–´–ô –ê–£–î–ò–¢ –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–ò CRM –°–ò–°–¢–ï–ú–´
**–î–∞—Ç–∞:** 20 –¥–µ–∫–∞–±—Ä—è 2025  
**–°—Ç–∞—Ç—É—Å:** –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏ —É—Å—Ç—Ä–∞–Ω–µ–Ω—ã, –æ—Å—Ç–∞–ª–∏—Å—å —É–ª—É—á—à–µ–Ω–∏—è

---

## ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–ù–´–ï –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –£–Ø–ó–í–ò–ú–û–°–¢–ò

### 1. ‚úÖ Session Hijacking (–ò–°–ü–†–ê–í–õ–ï–ù–û)
**–ë—ã–ª–æ:** –ù–µ–±–µ–∑–æ–ø–∞—Å–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ `userId` –≤ cookie
```typescript
// –£–Ø–ó–í–ò–ú–û–°–¢–¨: Cookie –º–æ–∂–Ω–æ –±—ã–ª–æ –ø–æ–¥–¥–µ–ª–∞—Ç—å
cookieStore.set('userId', user.id.toString())
```

**–°—Ç–∞–ª–æ:** iron-session —Å AES-256-GCM —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ–º
```typescript
// –ë–ï–ó–û–ü–ê–°–ù–û: –ö—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏ –∑–∞—â–∏—â–µ–Ω–Ω–∞—è —Å–µ—Å—Å–∏—è
await createSession(user.id, user.nicName)
```
**–ó–∞—â–∏—Ç–∞:** –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –ø–æ–¥–¥–µ–ª–∞—Ç—å –±–µ–∑ –∑–Ω–∞–Ω–∏—è `SESSION_SECRET`

---

### 2. ‚úÖ File Upload RCE (–ò–°–ü–†–ê–í–õ–ï–ù–û)
**–ë—ã–ª–æ:** –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –∑–∞–≥—Ä—É–∂–∞–µ–º—ã—Ö —Ñ–∞–π–ª–æ–≤
- –õ—é–±–æ–π –º–æ–≥ –∑–∞–≥—Ä—É–∑–∏—Ç—å `.exe`, `.sh`, `.pas`, `.php`
- –ù–∞–π–¥–µ–Ω —Ä–µ–∞–ª—å–Ω—ã–π —Ñ–∞–π–ª: `UnitStatGrant.pas` –≤ `public/media/p18/t205/`

**–°—Ç–∞–ª–æ:** –ö–æ–º–ø–ª–µ–∫—Å–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è
- 60+ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–π
- Magic bytes –ø—Ä–æ–≤–µ—Ä–∫–∞ (—Ä–µ–∞–ª—å–Ω–æ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ)
- –ó–∞—â–∏—Ç–∞ –æ—Ç –¥–≤–æ–π–Ω—ã—Ö —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–π (`file.pdf.exe`)
- Null byte injection –∑–∞—â–∏—Ç–∞
- Path traversal –∑–∞—â–∏—Ç–∞
- SQL —Ñ–∞–π–ª—ã —Ä–∞–∑—Ä–µ—à–µ–Ω—ã, –Ω–æ —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –Ω–∞ `xp_cmdshell`, `sp_configure`

---

### 3. ‚úÖ SQL Injection (–ó–ê–©–ò–©–ï–ù–û)
**–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ:** –í—Å–µ –∑–∞–ø—Ä–æ—Å—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–∞—Ü–∏—é
```typescript
// ‚úÖ –ë–ï–ó–û–ü–ê–°–ù–û: –ü–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã
await query(`SELECT * FROM Users WHERE login = @login`, { login })
```
**–°—Ç–∞—Ç—É—Å:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ç–∏–ø–∏–∑–∞—Ü–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –≤ `db/connect.ts`

---

## üî∂ –í–´–°–û–ö–ò–ô –†–ò–°–ö (—Ç—Ä–µ–±—É–µ—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è)

### 1. üî¥ XSS —á–µ—Ä–µ–∑ dangerouslySetInnerHTML
**–§–∞–π–ª:** `src/app/tasks/views/components/TaskDescription.tsx:94`
```tsx
// –£–Ø–ó–í–ò–ú–û–°–¢–¨: –í—ã–≤–æ–¥ –Ω–µ–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω–æ–≥–æ HTML
<div dangerouslySetInnerHTML={{ __html: description }} />
```

**–†–∏—Å–∫:**
- –ó–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ —Å–æ–∑–¥–∞–µ—Ç –∑–∞–¥–∞—á—É —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º: `<img src=x onerror="alert(document.cookie)">`
- XSS –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø—Ä–∏ –ø—Ä–æ—Å–º–æ—Ç—Ä–µ –∑–∞–¥–∞—á–∏ –¥—Ä—É–≥–∏–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
- –í–æ–∑–º–æ–∂–Ω–∞ –∫—Ä–∞–∂–∞ —Å–µ—Å—Å–∏–π (–µ—Å–ª–∏ –±—ã –Ω–µ httpOnly)

**–†–µ—à–µ–Ω–∏–µ:** DOMPurify –¥–ª—è —Å–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏–∏ HTML
```typescript
import DOMPurify from 'isomorphic-dompurify';
<div dangerouslySetInnerHTML={{ __html: DOMPurify.sanitize(description) }} />
```

---

### 2. üî¥ –ú–∞—Å—Ç–µ—Ä-–ø–∞—Ä–æ–ª—å –±–µ–∑ —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è
**–§–∞–π–ª:** `src/app/tasks/views/project/actions/getSecrets.ts:45`
```typescript
// –ö–†–ò–¢–ò–ß–ù–û: –ü–∞—Ä–æ–ª—å –ø—Ä–∏–Ω–∏–º–∞–µ—Ç—Å—è –ë–ï–ó –ø—Ä–æ–≤–µ—Ä–∫–∏!
return password.length >= 4;
```

**–†–∏—Å–∫:**
- –õ—é–±–æ–π –ø–∞—Ä–æ–ª—å >4 —Å–∏–º–≤–æ–ª–æ–≤ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç —Å–µ–∫—Ä–µ—Ç—ã –ø—Ä–æ–µ–∫—Ç–∞
- –°–µ–∫—Ä–µ—Ç—ã —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –ë–î –≤ –æ—Ç–∫—Ä—ã—Ç–æ–º –≤–∏–¥–µ (—Ç–∞–±–ª–∏—Ü–∞ `ProjectSecrets`)
- –ù–µ—Ç –∞—É–¥–∏—Ç–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ —Å–µ–∫—Ä–µ—Ç–∞–º

**–†–µ—à–µ–Ω–∏–µ:**
```typescript
// 1. –î–æ–±–∞–≤–∏—Ç—å –≤ —Ç–∞–±–ª–∏—Ü—É Project –ø–æ–ª–µ master_password_hash
// 2. –ü—Ä–∏ –ø–µ—Ä–≤–æ–π —É—Å—Ç–∞–Ω–æ–≤–∫–µ:
const hash = await bcrypt.hash(password, 10);
await query(`UPDATE Project SET master_password_hash = @hash WHERE id = @id`, {hash, id});

// 3. –ü—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ:
return await bcrypt.compare(password, storedHash);
```

---

### 3. üî¥ –õ–µ–≥–∞—Å–∏ –ø–∞—Ä–æ–ª–∏ –≤ –ë–î
**–°—Ç–∞—Ç—É—Å:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –º–∏–≥—Ä–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç, –Ω–æ —Ç—Ä–µ–±—É–µ—Ç—Å—è —Ñ–æ—Ä—Å–∏—Ä–æ–≤–∞–Ω–∏–µ

**–ù–∞–π–¥–µ–Ω–æ –≤ –∫–æ–¥–µ:**
```typescript
// login.ts:94 - –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–µ–≥–∞—Å–∏-–ø–∞—Ä–æ–ª—è –≤ –æ—Ç–∫—Ä—ã—Ç–æ–º –≤–∏–¥–µ
else if (storedPassword) {
  // Timing-safe, –Ω–æ –≤—Å—ë —Ä–∞–≤–Ω–æ –≤ –ë–î –æ—Ç–∫—Ä—ã—Ç—ã–π —Ç–µ–∫—Å—Ç
  isPasswordValid = crypto.timingSafeEqual(...)
}
```

**SQL –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏:**
```sql
SELECT COUNT(*) FROM Users WHERE password NOT LIKE '$2%';
```

**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è –º–∏–≥—Ä–∞—Ü–∏—è
```sql
-- –ù–∞–π—Ç–∏ –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –ª–µ–≥–∞—Å–∏-–ø–∞—Ä–æ–ª—è–º–∏
SELECT id, login, email FROM Users WHERE password NOT LIKE '$2%';

-- –û–ø—Ü–∏–∏:
-- 1. –û—Ç–ø—Ä–∞–≤–∏—Ç—å email —Å —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–µ–º —Å–º–µ–Ω—ã –ø–∞—Ä–æ–ª—è
-- 2. –ë–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –≤—Ö–æ–¥ –¥–æ —Å–º–µ–Ω—ã –ø–∞—Ä–æ–ª—è
-- 3. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –ø–∞—Ä–æ–ª—å –∏ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å
```

---

### 4. üî¥ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤ –∏ –ø–∞—Ä–æ–ª–µ–π
**–ù–∞–π–¥–µ–Ω–æ:**
```typescript
// verify.ts:9 - –û–ü–ê–°–ù–û: –ü–æ–ª–Ω—ã–π —Ç–æ–∫–µ–Ω –≤ –ª–æ–≥–∞—Ö!
console.log('üîç Full token:', token);

// register.ts:49 - –õ–æ–≥–∏—Ä—É–µ—Ç—Å—è userId –∏ email —Ä—è–¥–æ–º —Å —Ç–æ–∫–µ–Ω–æ–º
console.log('üîë Creating token:', { userId, email, token: '...' });
```

**–†–∏—Å–∫:**
- Production –ª–æ–≥–∏ —Å–æ–¥–µ—Ä–∂–∞—Ç —Ç–æ–∫–µ–Ω—ã –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏
- –ü—Ä–∏ —É—Ç–µ—á–∫–µ –ª–æ–≥–æ–≤ - –∫–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏—è –∞–∫–∫–∞—É–Ω—Ç–æ–≤

**–†–µ—à–µ–Ω–∏–µ:** –£–¥–∞–ª–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ production
```typescript
if (process.env.NODE_ENV !== 'production') {
  console.log('üîç Debug:', token.substring(0, 10) + '...');
}
```

---

## üî∂ –°–†–ï–î–ù–ò–ô –†–ò–°–ö

### 5. ‚ö†Ô∏è HTTPS –Ω–µ —Ñ–æ—Ä—Å–∏—Ä—É–µ—Ç—Å—è –≤ –ë–î
**–§–∞–π–ª:** `src/db/connect.ts:14`
```typescript
options: {
  encrypt: false, // ‚ùå –î–∞–Ω–Ω—ã–µ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –≤ –æ—Ç–∫—Ä—ã—Ç–æ–º –≤–∏–¥–µ
  trustServerCertificate: true,
}
```

**–†–∏—Å–∫:** MITM –∞—Ç–∞–∫–∞ –Ω–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î

**–†–µ—à–µ–Ω–∏–µ:**
```typescript
encrypt: process.env.NODE_ENV === 'production',
trustServerCertificate: process.env.NODE_ENV !== 'production',
```

---

### 6. ‚ö†Ô∏è –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ Rate Limiting
**–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ:** –ù–µ—Ç –∑–∞—â–∏—Ç—ã –æ—Ç brute force –Ω–∞ `/login`

**–¢–µ–∫—É—â–∞—è —É—è–∑–≤–∏–º–æ—Å—Ç—å:**
- –ú–æ–∂–Ω–æ –ø–µ—Ä–µ–±–∏—Ä–∞—Ç—å 1000+ –ø–∞—Ä–æ–ª–µ–π –≤ —Å–µ–∫—É–Ω–¥—É
- –ù–µ—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –ø–æ IP
- –ù–µ—Ç CAPTCHA

**–†–µ—à–µ–Ω–∏–µ:** Middleware —Å rate limiting
```typescript
import { Ratelimit } from "@upstash/ratelimit";
import { kv } from "@vercel/kv";

const ratelimit = new Ratelimit({
  redis: kv,
  limiter: Ratelimit.slidingWindow(5, "1 m"), // 5 –ø–æ–ø—ã—Ç–æ–∫ –≤ –º–∏–Ω—É—Ç—É
});

// –í login.ts:
const { success } = await ratelimit.limit(login);
if (!success) {
  return { error: '–°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –ø–æ–ø—ã—Ç–æ–∫. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —á–µ—Ä–µ–∑ –º–∏–Ω—É—Ç—É.' };
}
```

**–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ (–±–µ–∑ Redis):**
```typescript
// –í –ø–∞–º—è—Ç–∏ (—Å–±—Ä–æ—Å–∏—Ç—Å—è –ø—Ä–∏ —Ä–µ—Å—Ç–∞—Ä—Ç–µ)
const loginAttempts = new Map<string, {count: number, resetAt: number}>();
```

---

### 7. ‚ö†Ô∏è CSRF Protection
**–°—Ç–∞—Ç—É—Å:** Next.js Server Actions –∏–º–µ—é—Ç –≤—Å—Ç—Ä–æ–µ–Ω–Ω—É—é –∑–∞—â–∏—Ç—É, –ù–û...

**–ü—Ä–æ–±–ª–µ–º–∞:** –ù–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ `origin` –≤ middleware
```typescript
// proxy.ts - –¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É
const origin = req.headers.get('origin');
const host = req.headers.get('host');
if (origin && !allowedOrigins.includes(origin)) {
  return new Response('Forbidden', { status: 403 });
}
```

---

## üü° –ù–ò–ó–ö–ò–ô –†–ò–°–ö (—É–ª—É—á—à–µ–Ω–∏—è)

### 8. ‚ÑπÔ∏è –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤ .env
**–ù–∞–π–¥–µ–Ω–æ:** `.env` —Å–æ–¥–µ—Ä–∂–∏—Ç production credentials
```env
DB_PASSWORD=160378
SMTP_PASSWORD="ntnf jxox iean uqjw"
```

**–ü—Ä–æ–±–ª–µ–º–∞:**
- ‚úÖ `.env` –≤ `.gitignore` (–ø—Ä–∞–≤–∏–ª—å–Ω–æ!)
- ‚ö†Ô∏è –ù–æ —Ñ–∞–π–ª —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ –ø—Ä–æ–µ–∫—Ç–µ

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:**
```bash
# –ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å –≤ .env.local (–Ω–µ –≤ git)
mv .env .env.local

# –í .env –æ—Å—Ç–∞–≤–∏—Ç—å —Ç–æ–ª—å–∫–æ –ø—Ä–∏–º–µ—Ä—ã
# .env.example:
SESSION_SECRET=your-secret-here
DB_PASSWORD=your-password-here
```

---

### 9. ‚ÑπÔ∏è Content Security Policy
**–û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç:** CSP –∑–∞–≥–æ–ª–æ–≤–æ–∫

**–î–æ–±–∞–≤–∏—Ç—å –≤ `next.config.ts`:**
```typescript
async headers() {
  return [{
    source: '/:path*',
    headers: [
      {
        key: 'Content-Security-Policy',
        value: "default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval'; style-src 'self' 'unsafe-inline';"
      },
      {
        key: 'X-Frame-Options',
        value: 'DENY'
      },
      {
        key: 'X-Content-Type-Options',
        value: 'nosniff'
      }
    ]
  }];
}
```

---

### 10. ‚ÑπÔ∏è Secrets –≤ –ø—É–±–ª–∏—á–Ω–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
**–ù–∞–π–¥–µ–Ω–æ:** –§–∞–π–ª—ã –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –≤ `public/media/`

**–ü—Ä–æ–±–ª–µ–º–∞:**
- `public/` –¥–æ—Å—Ç—É–ø–µ–Ω –±–µ–∑ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- URL —Ñ–∞–π–ª–∞ –º–æ–∂–Ω–æ —É–≥–∞–¥–∞—Ç—å: `/media/p18/t205/file.pdf`

**–†–µ—à–µ–Ω–∏–µ:** –•—Ä–∞–Ω–∏—Ç—å –≤–Ω–µ public, —Ä–∞–∑–¥–∞–≤–∞—Ç—å —á–µ—Ä–µ–∑ API
```typescript
// app/api/media/[projectId]/[filename]/route.ts
export async function GET(req, { params }) {
  const session = await getSession();
  if (!session.isLoggedIn) return new Response('Unauthorized', {status: 401});
  
  // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –Ω–∞ –ø—Ä–æ–µ–∫—Ç
  const hasAccess = await checkProjectAccess(session.userId, params.projectId);
  if (!hasAccess) return new Response('Forbidden', {status: 403});
  
  // –ß—Ç–µ–Ω–∏–µ —Ñ–∞–π–ª–∞ –∏–∑ –ø—Ä–∏–≤–∞—Ç–Ω–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
  const file = await fs.readFile(`/uploads/p${params.projectId}/${params.filename}`);
  return new Response(file);
}
```

---

## üìä –°–í–û–î–ù–ê–Ø –¢–ê–ë–õ–ò–¶–ê

| # | –£—è–∑–≤–∏–º–æ—Å—Ç—å | –†–∏—Å–∫ | –°—Ç–∞—Ç—É—Å | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç |
|---|------------|------|--------|-----------|
| 1 | Session Hijacking | üî¥ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π | ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ | - |
| 2 | File Upload RCE | üî¥ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π | ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ | - |
| 3 | SQL Injection | üî¥ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π | ‚úÖ –ó–∞—â–∏—â–µ–Ω–æ | - |
| 4 | XSS (dangerouslySetInnerHTML) | üî¥ –í—ã—Å–æ–∫–∏–π | ‚ùå –¢—Ä–µ–±—É–µ—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è | 1 |
| 5 | –ú–∞—Å—Ç–µ—Ä-–ø–∞—Ä–æ–ª—å –±–µ–∑ —Ö–µ—à–∞ | üî¥ –í—ã—Å–æ–∫–∏–π | ‚ùå –¢—Ä–µ–±—É–µ—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è | 2 |
| 6 | –õ–µ–≥–∞—Å–∏ –ø–∞—Ä–æ–ª–∏ –≤ –ë–î | üî¥ –í—ã—Å–æ–∫–∏–π | ‚ö†Ô∏è –ß–∞—Å—Ç–∏—á–Ω–æ | 3 |
| 7 | –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤ | üî¥ –í—ã—Å–æ–∫–∏–π | ‚ùå –¢—Ä–µ–±—É–µ—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è | 4 |
| 8 | HTTPS –¥–ª—è –ë–î | üî∂ –°—Ä–µ–¥–Ω–∏–π | ‚ùå –¢—Ä–µ–±—É–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ | 5 |
| 9 | Rate Limiting | üî∂ –°—Ä–µ–¥–Ω–∏–π | ‚ùå –¢—Ä–µ–±—É–µ—Ç –≤–Ω–µ–¥—Ä–µ–Ω–∏—è | 6 |
| 10 | CSRF Protection | üî∂ –°—Ä–µ–¥–Ω–∏–π | ‚ö†Ô∏è –ß–∞—Å—Ç–∏—á–Ω–æ | 7 |
| 11 | .env –≤ –ø—Ä–æ–µ–∫—Ç–µ | üü° –ù–∏–∑–∫–∏–π | ‚ö†Ô∏è –£–ª—É—á—à–∏—Ç—å | 8 |
| 12 | CSP –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç | üü° –ù–∏–∑–∫–∏–π | ‚ùå –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è | 9 |
| 13 | public/ —Ñ–∞–π–ª—ã | üü° –ù–∏–∑–∫–∏–π | ‚ùå –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è | 10 |

---

## üöÄ –ü–õ–ê–ù –î–ï–ô–°–¢–í–ò–ô

### –ù–µ–º–µ–¥–ª–µ–Ω–Ω–æ (–≤ —Ç–µ—á–µ–Ω–∏–µ –¥–Ω—è):
1. ‚úÖ ~~–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å iron-session~~ (–°–î–ï–õ–ê–ù–û)
2. ‚úÖ ~~–í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–∞–π–ª–æ–≤~~ (–°–î–ï–õ–ê–ù–û)
3. **TODO:** –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å DOMPurify –∏ —Å–∞–Ω–∏—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å HTML
4. **TODO:** –£–¥–∞–ª–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤ –≤ production

### –ù–∞ —ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ:
5. –î–æ–±–∞–≤–∏—Ç—å —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –º–∞—Å—Ç–µ—Ä-–ø–∞—Ä–æ–ª—è –ø—Ä–æ–µ–∫—Ç–æ–≤
6. –§–æ—Ä—Å–∏—Ä–æ–≤–∞—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é –≤—Å–µ—Ö –ª–µ–≥–∞—Å–∏-–ø–∞—Ä–æ–ª–µ–π
7. –í–∫–ª—é—á–∏—Ç—å TLS –¥–ª—è –ë–î –≤ production
8. –î–æ–±–∞–≤–∏—Ç—å –±–∞–∑–æ–≤—ã–π rate limiting

### –í —Å–ª–µ–¥—É—é—â–µ–º –º–µ—Å—è—Ü–µ:
9. –í–Ω–µ–¥—Ä–∏—Ç—å CSP
10. –ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑ public/
11. –î–æ–±–∞–≤–∏—Ç—å –∞—É–¥–∏—Ç –ª–æ–≥–∏ –¥–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
12. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

---

## üìù –ü–†–û–í–ï–†–û–ß–ù–´–ô –°–ü–ò–°–û–ö

```bash
# 1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–µ—Å—Å–∏–∏
curl -H "Cookie: crm_session=fake" http://localhost:3001/dashboard
# –î–æ–ª–∂–Ω–æ —Ä–µ–¥–∏—Ä–µ–∫—Ç–∏—Ç—å –Ω–∞ /login

# 2. –ü–æ–ø—ã—Ç–∫–∞ –∑–∞–≥—Ä—É–∑–∏—Ç—å .exe
# –î–æ–ª–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å –æ—à–∏–±–∫—É –≤–∞–ª–∏–¥–∞—Ü–∏–∏

# 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å SQL injection
# login=admin' OR '1'='1
# –î–æ–ª–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å "–ù–µ–≤–µ—Ä–Ω—ã–π –ª–æ–≥–∏–Ω –∏–ª–∏ –ø–∞—Ä–æ–ª—å"

# 4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å XSS
# –°–æ–∑–¥–∞—Ç—å –∑–∞–¥–∞—á—É —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º: <script>alert(1)</script>
# –¢–ï–ö–£–©–ò–ô –°–¢–ê–¢–£–°: –°–∫—Ä–∏–ø—Ç –≤—ã–ø–æ–ª–Ω–∏—Ç—Å—è (–£–Ø–ó–í–ò–ú–û!)
```

---

## ‚ö° –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ö–û–ú–ê–ù–î–´

```bash
# –ù–∞–π—Ç–∏ –≤—Å–µ –ª–µ–≥–∞—Å–∏-–ø–∞—Ä–æ–ª–∏
sqlcmd -S sql.argoai.ru -d MizerCRM -U mizer -P 160378 -Q "SELECT COUNT(*) FROM Users WHERE password NOT LIKE '$2%'"

# –ó–∞–ø—É—Å—Ç–∏—Ç—å SQL –∞—É–¥–∏—Ç —Ñ–∞–π–ª–æ–≤
sqlcmd -S sql.argoai.ru -d MizerCRM -U mizer -i sql/security_check_files.sql -o audit_results.txt

# –ù–∞–π—Ç–∏ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã –≤ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
Get-ChildItem -Path public/media -Recurse -Include *.exe,*.dll,*.sh,*.pas,*.php | Select-Object FullName,Length,CreationTime
```

---

**–ò—Ç–æ–≥–æ:** –ò–∑ 13 —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π **3 –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã**, **4 –≤—ã—Å–æ–∫–æ–≥–æ —Ä–∏—Å–∫–∞ —Ç—Ä–µ–±—É—é—Ç –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ–≥–æ –≤–Ω–∏–º–∞–Ω–∏—è**.
