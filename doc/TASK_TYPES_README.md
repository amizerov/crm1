# Редактор типов задач в проектах

## Описание
Добавлен функционал редактирования типов задач в рамках каждого проекта. Каждый проект теперь может иметь свои собственные типы задач с настраиваемыми названиями, цветами и порядком отображения.

## Структура базы данных

### Таблица TaskTypes
```sql
CREATE TABLE [dbo].[TaskTypes](
    [id] [int] IDENTITY(1,1) NOT NULL,
    [projectId] [int] NOT NULL,
    [typeName] [nvarchar](50) NOT NULL,
    [typeOrder] [int] NOT NULL,
    [typeColor] [nvarchar](50) NULL,
    CONSTRAINT [PK_TaskTypes] PRIMARY KEY CLUSTERED ([id] ASC),
    CONSTRAINT [FK_TaskTypes_Project] FOREIGN KEY([projectId]) 
        REFERENCES [dbo].[Project] ([id]) ON DELETE CASCADE
);
```

Поля:
- `id` - уникальный идентификатор типа задач
- `projectId` - связь с проектом 
- `typeName` - название типа задач
- `typeOrder` - порядок отображения в интерфейсе
- `typeColor` - цвет для визуального отображения (hex формат)

## Функциональность

### 1. Добавление типов задач
- Ввод названия типа задач
- Выбор цвета для визуального отображения
- Автоматическое определение порядка

### 2. Редактирование типов задач
- Изменение названия типа
- Изменение цвета
- Inline редактирование прямо в списке

### 3. Удаление типов задач
- Подтверждение удаления
- Удаление с проверкой

### 4. Изменение порядка
- Drag & Drop для изменения порядка
- Автоматическое сохранение нового порядка
- Визуальные индикаторы порядка

## Файлы

### Backend (Server Actions)
- `src/app/projects/actions/taskTypeActions.ts` - все серверные действия для работы с типами задач

### Frontend (Компоненты)
- `src/app/projects/edit/[id]/ProjectTaskTypeEditor.tsx` - компонент редактора типов задач
- `src/app/projects/edit/[id]/page.tsx` - обновлен для включения редактора типов задач

### База данных
- `sql/create_task_types_table.sql` - миграция для создания таблицы TaskTypes

## API методы

### getProjectTaskTypes(projectId: number)
Получение всех типов задач для проекта, отсортированных по порядку.

### createTaskType(data)
Создание нового типа задач с параметрами:
- projectId: number
- typeName: string  
- typeOrder: number
- typeColor?: string

### updateTaskType(data)
Обновление существующего типа задач:
- id: number
- typeName: string
- typeColor?: string

### deleteTaskType(id: number)
Удаление типа задач по ID.

### reorderTaskTypes(updates)
Изменение порядка типов задач массовым обновлением.

## Интеграция

Редактор типов задач интегрирован в страницу редактирования проекта (`/projects/edit/[id]`) и отображается после редактора статусов проекта.

## Безопасность

- Все SQL запросы используют параметризованные запросы для предотвращения SQL инъекций
- Проверка прав доступа через существующую систему аутентификации
- Валидация входных данных

## UI/UX особенности

- Интуитивно понятный интерфейс в стиле остальных редакторов
- Drag & Drop для изменения порядка
- Inline редактирование
- Цветовые индикаторы для типов задач
- Подтверждение опасных операций (удаление)
- Отзывчивый дизайн

## Использование

1. Перейти на страницу редактирования проекта
2. Прокрутить до секции "Типы задач проекта"
3. Добавить новые типы или редактировать существующие
4. Использовать drag & drop для изменения порядка
5. Изменения сохраняются автоматически