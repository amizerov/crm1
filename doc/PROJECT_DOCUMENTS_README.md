# –ö–æ–º–ø–æ–Ω–µ–Ω—Ç —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞–º–∏ –ø—Ä–æ–µ–∫—Ç–∞

## –û–ø–∏—Å–∞–Ω–∏–µ

–ö–æ–º–ø–æ–Ω–µ–Ω—Ç `Documents.tsx` –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –ø–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞–º–∏ –ø—Ä–æ–µ–∫—Ç–∞ —Å –¥–≤—É–º—è —Ä–µ–∂–∏–º–∞–º–∏ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞:
- **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö** - –¥–æ–∫—É–º–µ–Ω—Ç—ã, –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –≤ –ë–î (–∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ —á–µ—Ä–µ–∑ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å)
- **–§–∞–π–ª–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞** - –≤—Å–µ —Ñ–∞–π–ª—ã –≤ –ø–∞–ø–∫–µ –ø—Ä–æ–µ–∫—Ç–∞, –≤–∫–ª—é—á–∞—è –¥–æ–∫—É–º–µ–Ω—Ç—ã –∏–∑ –∑–∞–¥–∞—á

## –§–∞–π–ª—ã

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
- `src/app/tasks/views/project/components/Documents.tsx` - –æ—Å–Ω–æ–≤–Ω–æ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç

### Server Actions
- `src/app/tasks/views/project/actions/uploadDocument.ts` - –∑–∞–≥—Ä—É–∑–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
- `src/app/tasks/views/project/actions/deleteDocument.ts` - —É–¥–∞–ª–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤  
- `src/app/tasks/views/project/actions/scanFiles.ts` - —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã

### SQL
- `sql/create_project_documents_table.sql` - —Å–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã ProjectDocuments

## –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª

### 1. –ü—Ä–æ—Å–º–æ—Ç—Ä –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤

#### –†–µ–∂–∏–º "–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö"
- –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –¥–æ–∫—É–º–µ–Ω—Ç—ã –∏–∑ —Ç–∞–±–ª–∏—Ü—ã `ProjectDocuments` (–ø—Ä—è–º–æ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ –≤ –ø—Ä–æ–µ–∫—Ç)
- –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –¥–æ–∫—É–º–µ–Ω—Ç—ã –∏–∑ —Ç–∞–±–ª–∏—Ü—ã `TaskDocuments` (–∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ –≤ –∑–∞–¥–∞—á–∏ –ø—Ä–æ–µ–∫—Ç–∞)
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ: —Ä–∞–∑–º–µ—Ä, –∞–≤—Ç–æ—Ä, –¥–∞—Ç–∞ –∑–∞–≥—Ä—É–∑–∫–∏
- –û—Ç–º–µ—á–∞–µ—Ç –∏—Å—Ç–æ—á–Ω–∏–∫ –¥–æ–∫—É–º–µ–Ω—Ç–∞ (–ø—Ä–æ–µ–∫—Ç/–∑–∞–¥–∞—á–∞)

#### –†–µ–∂–∏–º "–§–∞–π–ª–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞"
- –°–∫–∞–Ω–∏—Ä—É–µ—Ç –ø–∞–ø–∫—É `public/media/p{projectId}/`
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤—Å–µ —Ñ–∞–π–ª—ã –∏–∑ –ø–∞–ø–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞
- –†–µ–∫—É—Ä—Å–∏–≤–Ω–æ —Å–∫–∞–Ω–∏—Ä—É–µ—Ç –ø–∞–ø–∫–∏ –∑–∞–¥–∞—á `t{taskId}`
- –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç —Ä–∞–∑–º–µ—Ä –∏ –¥–∞—Ç—É –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Ñ–∞–π–ª–∞

### 2. –ó–∞–≥—Ä—É–∑–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
- –ö–Ω–æ–ø–∫–∞ "–ó–∞–≥—Ä—É–∑–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç" –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –¥–∏–∞–ª–æ–≥ –≤—ã–±–æ—Ä–∞ —Ñ–∞–π–ª–∞
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞: –º–∞–∫—Å–∏–º—É–º 50 –ú–ë
- –§–∞–π–ª—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ `public/media/p{projectId}/`
- –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è —É–Ω–∏–∫–∞–ª—å–Ω–æ–µ –∏–º—è: `doc_{timestamp}_{random}.{ext}`
- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –≤ —Ç–∞–±–ª–∏—Ü—É `ProjectDocuments`

### 3. –ü—Ä–æ—Å–º–æ—Ç—Ä –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
- –ö–Ω–æ–ø–∫–∞ "–ü—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å" (–∏–∫–æ–Ω–∫–∞ –≥–ª–∞–∑–∞) –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –¥–æ–∫—É–º–µ–Ω—Ç –≤ –Ω–æ–≤–æ–π –≤–∫–ª–∞–¥–∫–µ –±—Ä–∞—É–∑–µ—Ä–∞
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –ø—Ä–æ—Å–º–æ—Ç—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π, PDF –∏ –¥—Ä—É–≥–∏—Ö —Ç–∏–ø–æ–≤ —Ñ–∞–π–ª–æ–≤
- –ë—Ä–∞—É–∑–µ—Ä –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Å–ø–æ—Å–æ–± –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ MIME-—Ç–∏–ø–∞

### 4. –°–∫–∞—á–∏–≤–∞–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
- –ö–Ω–æ–ø–∫–∞ "–°–∫–∞—á–∞—Ç—å" (–∏–∫–æ–Ω–∫–∞ —Å—Ç—Ä–µ–ª–∫–∏ –≤–Ω–∏–∑) —Å–∫–∞—á–∏–≤–∞–µ—Ç —Ñ–∞–π–ª
- –§–∞–π–ª —Å–∫–∞—á–∏–≤–∞–µ—Ç—Å—è —Å –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–º –∏–º–µ–Ω–µ–º

### 5. –£–¥–∞–ª–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
- –ö–Ω–æ–ø–∫–∞ "–£–¥–∞–ª–∏—Ç—å" (–∏–∫–æ–Ω–∫–∞ –∫–æ—Ä–∑–∏–Ω—ã) –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–∞–µ—Ç –æ –Ω–µ–æ–±—Ä–∞—Ç–∏–º–æ—Å—Ç–∏ –¥–µ–π—Å—Ç–≤–∏—è
- –ü—Ä–∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–∏ —É–¥–∞–ª—è–µ—Ç—Å—è:
  - –§–∏–∑–∏—á–µ—Å–∫–∏–π —Ñ–∞–π–ª –∏–∑ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã
  - –ó–∞–ø–∏—Å—å –∏–∑ —Ç–∞–±–ª–∏—Ü—ã –ë–î
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤: —É–¥–∞–ª–∏—Ç—å –º–æ–∂–µ—Ç —Ç–æ–ª—å–∫–æ –∑–∞–≥—Ä—É–∑–∏–≤—à–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å

## –ò–∫–æ–Ω–∫–∏ —Ñ–∞–π–ª–æ–≤

–ö–æ–º–ø–æ–Ω–µ–Ω—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–±–∏—Ä–∞–µ—Ç –∏–∫–æ–Ω–∫—É –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–∏–ø–∞ —Ñ–∞–π–ª–∞:
- üñºÔ∏è **–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è** (jpg, png, gif, webp, svg) - –∑–µ–ª—ë–Ω–∞—è –∏–∫–æ–Ω–∫–∞
- üìÑ **PDF** - –∫—Ä–∞—Å–Ω–∞—è –∏–∫–æ–Ω–∫–∞
- üìù **Word –¥–æ–∫—É–º–µ–Ω—Ç—ã** (doc, docx) - —Å–∏–Ω—è—è –∏–∫–æ–Ω–∫–∞
- üìä **Excel —Ç–∞–±–ª–∏—Ü—ã** (xls, xlsx) - –∏–∑—É–º—Ä—É–¥–Ω–∞—è –∏–∫–æ–Ω–∫–∞
- üì¶ **–ê—Ä—Ö–∏–≤—ã** (zip, rar, 7z) - —è–Ω—Ç–∞—Ä–Ω–∞—è –∏–∫–æ–Ω–∫–∞
- üìÑ **–î—Ä—É–≥–∏–µ —Ñ–∞–π–ª—ã** - —Å–µ—Ä–∞—è –∏–∫–æ–Ω–∫–∞

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ë–î

### –¢–∞–±–ª–∏—Ü–∞ ProjectDocuments

```sql
CREATE TABLE ProjectDocuments (
    id INT IDENTITY(1,1) PRIMARY KEY,
    project_id INT NOT NULL,
    filename NVARCHAR(255) NOT NULL,        -- –∏–º—è —Ñ–∞–π–ª–∞ –≤ —Å–∏—Å—Ç–µ–º–µ
    originalName NVARCHAR(255) NOT NULL,    -- –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ –∏–º—è —Ñ–∞–π–ª–∞
    filePath NVARCHAR(500) NOT NULL,        -- –ø—É—Ç—å –∫ —Ñ–∞–π–ª—É
    mimeType NVARCHAR(100) NOT NULL,        -- MIME-—Ç–∏–ø —Ñ–∞–π–ª–∞
    fileSize BIGINT NOT NULL,                -- —Ä–∞–∑–º–µ—Ä –≤ –±–∞–π—Ç–∞—Ö
    uploaded_by INT NOT NULL,                -- ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    uploaded_at DATETIME NOT NULL,           -- –¥–∞—Ç–∞ –∑–∞–≥—Ä—É–∑–∫–∏
    CONSTRAINT FK_ProjectDocuments_Project FOREIGN KEY (project_id) REFERENCES Project(id) ON DELETE CASCADE,
    CONSTRAINT FK_ProjectDocuments_User FOREIGN KEY (uploaded_by) REFERENCES [Users](id)
);
```

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–∞–ø–æ–∫

```
public/
‚îî‚îÄ‚îÄ media/
    ‚îî‚îÄ‚îÄ p{projectId}/           # –ü–∞–ø–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞
        ‚îú‚îÄ‚îÄ doc_*.jpg           # –î–æ–∫—É–º–µ–Ω—Ç—ã –ø—Ä–æ–µ–∫—Ç–∞
        ‚îú‚îÄ‚îÄ doc_*.pdf
        ‚îî‚îÄ‚îÄ t{taskId}/          # –ü–∞–ø–∫–∞ –∑–∞–¥–∞—á–∏
            ‚îú‚îÄ‚îÄ img_*.png       # –î–æ–∫—É–º–µ–Ω—Ç—ã –∑–∞–¥–∞—á–∏
            ‚îî‚îÄ‚îÄ file_*.docx
```

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ ProjectView

```tsx
import Documents from './components/Documents';

// –í –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ
{activeTab === 'documents' && (
  <Documents 
    projectId={projectId}
    documents={documents}
    onDocumentsChanged={loadProjectData}
  />
)}
```

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –¢–µ–∫—É—â–∏–µ –º–µ—Ä—ã
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- ‚úÖ –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ —Ñ–∞–π–ª–∞ (50 –ú–ë)
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ (—Ç–æ–ª—å–∫–æ –∞–≤—Ç–æ—Ä)
- ‚úÖ –£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∏–º–µ–Ω–∞ —Ñ–∞–π–ª–æ–≤ (–ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∏)

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è
- üî≤ –í–∞–ª–∏–¥–∞—Ü–∏—è —Ç–∏–ø–æ–≤ —Ñ–∞–π–ª–æ–≤ (–±–µ–ª—ã–π —Å–ø–∏—Å–æ–∫ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–π)
- üî≤ –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ –≤–∏—Ä—É—Å—ã –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
- üî≤ –ó–∞—â–∏—Ç–∞ –æ—Ç directory traversal –∞—Ç–∞–∫
- üî≤ Rate limiting –¥–ª—è –∑–∞–≥—Ä—É–∑–æ–∫
- üî≤ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–≤–æ—Ç —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è/–ø—Ä–æ–µ–∫—Ç–∞
- üî≤ –•—Ä–∞–Ω–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ –≤–Ω–µ public (–≤—ã–¥–∞—á–∞ —á–µ—Ä–µ–∑ –∑–∞—â–∏—â—ë–Ω–Ω—ã–π endpoint)

## TODO

- [ ] –î–æ–±–∞–≤–∏—Ç—å –º–∞—Å—Å–æ–≤—É—é –∑–∞–≥—Ä—É–∑–∫—É —Ñ–∞–π–ª–æ–≤ (drag & drop)
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø—Ä–µ–≤—å—é –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- [ ] –î–æ–±–∞–≤–∏—Ç—å –ø–æ–∏—Å–∫ –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
- [ ] –î–æ–±–∞–≤–∏—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö
- [ ] –≠–∫—Å–ø–æ—Ä—Ç —Å–ø–∏—Å–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
- [ ] –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –Ω–æ–≤—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ö
- [ ] –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
